<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>DnL Map</title>
	</head>
	<body>

		<div class="dnl"></div>

		<form class="controls export">
			<input type="submit" data-action="export-as-png" value="Export as PNG">
		</form>

		<script>
		  $(document).ready(function() {
		    var backgroundImage = new Image()
		    backgroundImage.src = 'dnl_map.png';

		    var lc = LC.init(
		        document.getElementsByClassName('dnl')[0],
		        {
		          backgroundShapes: [
		            LC.createShape(
		              'Image', {x: 20, y: 20, image: backgroundImage, scale: 2}),
		            LC.createShape(
		              'Text', {
		                x: 200, y: 200, text: "I am in the background",
		                font: "bold 12px Helvetica"
		              })
		          ]
		          $('.controls.export [data-action=export-as-png]').click(function(e) {
				      e.preventDefault();
				      window.open(lc.getImage().toDataURL());
				    })
		        });
		    // the background image is not included in the shape list that is
		    // saved/loaded here
		    var localStorageKey = 'drawing-with-background'
		    if (localStorage.getItem(localStorageKey)) {
		      lc.loadSnapshotJSON(localStorage.getItem(localStorageKey));
		    }
		    lc.on('drawingChange', function() {
		      localStorage.setItem(localStorageKey, lc.getSnapshotJSON());
		    });
		  });
		</script>

	</body>
</html>
